<html>
	<head>

		<meta http-equiv="Content-type" content="text/html; charset=utf-8">
		<title>SourceData Form integration</title>



		<!-- 1. Add polyfills library for browsers that don't support web components or download it from: https://github.com/webcomponents/webcomponentsjs/ -->
		<script src="https://search.sourcedata.io/lib/webcomponents-lite.min.js" type="text/javascript" charset="utf-8"></script>


		<!-- 2. Add link[rel="import"] tag to SourceData App -->
		<link rel="import" href="https://search.sourcedata.io/">


	</head>
	<body style = 'margin: 30px; width: 1280px;'>
		<div class = 'container-fluid'>
			<h1>This is a test of SourceData web form integration</h1>

			<!-- 3. Add container of sdForm -->
			<div id = 'SourceDataFormContainer'></div>



			<h3 class = 'page-header'>This is a test</h3>
				<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit,
					sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
					Ut enim ad minim veniam,
					quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
					Duis aute irure dolor in reprehenderit in voluptate velit esse
					cillum dolore eu fugiat nulla pariatur.
					Excepteur sint occaecat cupidatat non proident,
					sunt in culpa qui officia deserunt mollit anim id est laborum.
				</p>
		</div>
	</body>


    <script>

		var angularLoaded = false;

		function showForm(){

			// set location href
			var hashIdx = window.location.href.indexOf('#');
 		    window.location.href = window.location.href.substr(0,hashIdx)+"#/form";

			// first loading of SourceData Smart Figure
			if(!angularLoaded){

				// we create a div to contain the app
			    var div = document.querySelector('#SourceDataForm');
				if(!div){
					div = document.createElement('div');
					div.id = 'SourceDataForm';
				}

				// we append the div to the correct place in the dom
				document.querySelector('#SourceDataFormContainer').appendChild(div);

				// we get the content of SourceData App
				var content = document.querySelector('link[rel="import"]').import;
			    var el = content.querySelector('body');
				el.style.height = '300px';
			    div.appendChild(el.cloneNode(true));

				// we bootstrap the angular of SourceData App for the first time //
				angular.element(function() {
				      angular.bootstrap(document, ['publicSourcedataApp']);
					  angularLoaded = true;
		    	});
			}
			else{

				// we move the SourceData App to the correct place
				var div = document.querySelector('#SourceDataForm');
				document.querySelector('#SourceDataForm').appendChild(div);
			}
		}
		showForm();
     </script>
</html>